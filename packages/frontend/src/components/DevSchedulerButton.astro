---
// Dev-only button to trigger the scheduler
---

{import.meta.env.DEV && (
  <scheduler-button>
    <button class="btn btn-sm btn-outline">
      ğŸ”„ Scheduler ausfÃ¼hren
    </button>
  </scheduler-button>
)}

{import.meta.env.DEV && (
  <script>
    class SchedulerButton extends HTMLElement {
      connectedCallback() {
        const btn = this.querySelector('button')
        if (!btn) return

        btn.addEventListener('click', async () => {
          btn.disabled = true
          btn.textContent = 'â³ LÃ¤uft...'
          try {
            const res = await fetch('/api/dev/run-scheduler', { method: 'POST' })
            if (res.ok) {
              btn.textContent = 'âœ… Fertig!'
              setTimeout(() => location.reload(), 500)
            } else {
              btn.textContent = 'âŒ Fehler'
            }
          } catch {
            btn.textContent = 'âŒ Fehler'
          }
          setTimeout(() => {
            btn.disabled = false
            btn.textContent = 'ğŸ”„ Scheduler ausfÃ¼hren'
          }, 2000)
        })
      }
    }

    customElements.define('scheduler-button', SchedulerButton)
  </script>
)}
